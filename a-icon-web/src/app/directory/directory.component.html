<div class="directory-container">
  <div class="header">
    <h1>üìÅ Favicon Directory</h1>
    <p class="subtitle">Browse all generated favicons</p>
    <button class="btn btn-primary" (click)="goToUpload()">
      ‚Üê Upload New Image
    </button>
  </div>

  @if (loading()) {
    <div class="loading">
      <div class="spinner"></div>
      <p>Loading favicons...</p>
    </div>
  } @else if (error()) {
    <div class="error-message">
      <p>{{ error() }}</p>
      <button class="btn btn-secondary" (click)="goToUpload()">
        Go to Upload
      </button>
    </div>
  } @else if (favicons().length === 0) {
    <div class="empty-state">
      <p>No favicons generated yet.</p>
      <button class="btn btn-primary" (click)="goToUpload()">
        Upload Your First Image
      </button>
    </div>
  } @else {
    <div class="controls">
      <div class="sort-controls">
        <span>Sort by:</span>
        <button
          class="sort-btn"
          [class.active]="sortField() === 'createdAt'"
          (click)="setSortField('createdAt')"
        >
          Date
          @if (sortField() === 'createdAt') {
            <span class="sort-arrow">{{ sortOrder() === 'asc' ? '‚Üë' : '‚Üì' }}</span>
          }
        </button>
        <button
          class="sort-btn"
          [class.active]="sortField() === 'slug'"
          (click)="setSortField('slug')"
        >
          Slug
          @if (sortField() === 'slug') {
            <span class="sort-arrow">{{ sortOrder() === 'asc' ? '‚Üë' : '‚Üì' }}</span>
          }
        </button>
      </div>
      <div class="count">
        {{ favicons().length }} favicon{{ favicons().length !== 1 ? 's' : '' }}
      </div>
    </div>

    <div class="favicons-grid">
      @for (favicon of favicons(); track favicon.id) {
        <div class="favicon-card">
          <div class="favicon-preview">
            <img
              [src]="favicon.sourceUrl"
              [alt]="favicon.slug"
              loading="lazy"
            />
          </div>
          <div class="favicon-info">
            <h3 class="favicon-slug">{{ favicon.slug }}</h3>
            <p class="favicon-date">{{ formatDate(favicon.createdAt) }}</p>
            <p class="favicon-assets">{{ favicon.assetCount }} assets</p>
          </div>
          <div class="favicon-actions">
            <button
              class="btn btn-small btn-icon btn-preview"
              (click)="previewInBrowser(favicon.sourceUrl, $event)"
              title="Preview in browser tab"
            >
              ‚ñ∂Ô∏è
            </button>
            <a
              [routerLink]="['/favicon', favicon.slug]"
              class="btn btn-small btn-view"
            >
              View Details
            </a>
            <button
              class="btn btn-small btn-copy"
              (click)="copyToClipboard(favicon.sourceUrl, $event)"
            >
              Copy URL
            </button>
          </div>
        </div>
      }
    </div>
  }
</div>

